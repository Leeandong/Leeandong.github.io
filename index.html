<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.2.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.2.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.2.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.2.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.2.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Andong&#39;s Blogs">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Andong&#39;s Blogs">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Andong&#39;s Blogs">






  <link rel="canonical" href="http://yoursite.com/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Andong's Blogs</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Andong's Blogs</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Home</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />Archives</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/27/ESTL9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Andong Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Andong's Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/27/ESTL9/" itemprop="url">
                  Effective STL 9
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-08-27 16:10:08 / Modified: 21:56:33" itemprop="dateCreated datePublished" datetime="2018-08-27T16:10:08+08:00">2018-08-27</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="第9条：慎重选择所要删除的元素"><a href="#第9条：慎重选择所要删除的元素" class="headerlink" title="第9条：慎重选择所要删除的元素"></a>第9条：慎重选择所要删除的元素</h3><p>删除元素<algorithm>提供了 remove 函数 具体如下</algorithm></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ForwardIterator remove (ForwardIterator first, ForwardIterator last, const T&amp; val);</span><br></pre></td></tr></table></figure>
<p>返回值是一个迭代器，如果有n个元素被删除，则返回值就是 last - n</p>
<h4 id="remove-删除示例"><a href="#remove-删除示例" class="headerlink" title="remove 删除示例"></a>remove 删除示例</h4><h5 id="删除特定值"><a href="#删除特定值" class="headerlink" title="删除特定值"></a>删除特定值</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; v = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>&#125;</span><br><span class="line">remove(v.begin(), v.end(), <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<ol>
<li>标出所有的空位: 1 (2) 3 (2) 5</li>
<li>3向前移动，弥补第一个空位 1 3 (3) (2) 5</li>
<li>5向前移动，弥补第二个空位 1 3 5 (2)  (5)</li>
<li>剩下的元素没有可以过来填补空位的， 则删除结束，最终区间变为 1 3 5 2 5</li>
</ol>
<p>如此， 如果要完成我们理想的删除所有元素的工作，我们则应该使用</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v.erase(remove(v.begin(), v.end(), <span class="number">2</span>), v.end());</span><br></pre></td></tr></table></figure>
<p>remove 函数不能作用在关联容器上，关联容器若要完成删除某个值的元素直接调用 erase 函数即可</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> &lt;<span class="keyword">int</span>&gt; s = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>&#125;</span><br><span class="line">s.erase(<span class="number">2</span>);</span><br></pre></td></tr></table></figure>
<h5 id="删除特定的表达式"><a href="#删除特定的表达式" class="headerlink" title="删除特定的表达式"></a>删除特定的表达式</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">badValue</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br></pre></td></tr></table></figure>
<p>如果不是关联容器， 则将remove 对应换为 remove_if 即可</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; v = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>&#125;</span><br><span class="line">v.erase(remove(v.begin(), v.end(), badValue), v.end());</span><br><span class="line"><span class="built_in">list</span> &lt;<span class="keyword">int</span>&gt; l = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>&#125;</span><br><span class="line">l.remove_if(badValue);</span><br></pre></td></tr></table></figure>
<p>但对于关联容器则需要遍历来观察是否满足条件从而删除指定的元素,下面的做法是自然而然能想到的</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AssocContainer &lt;<span class="keyword">int</span>&gt; c;</span><br><span class="line"><span class="keyword">for</span>(AssocContainer &lt;<span class="keyword">int</span>&gt; :: iterator i = c.begin(); i!=c.end(); ++i)&#123;</span><br><span class="line">    <span class="keyword">if</span> (badValue(*i)) c.erase(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是这个做法是错误的。<strong>当容器内的一个元素被删除时，指向该元素的所有迭代器都会变得无效。</strong>也就是说，一旦c.erase(i) 返回， i 就成了无效值。上述循环中的 ++i自然也就是无效的。</p>
<p>有一个简单的改正的方法，既然容器内的元素被删除时候，指向该元素的所有迭代器都会变得无效，那我们只要在调用erase之前，有一个迭代器能够指向c中的下一个元素就好了，也就是调用时使用后置递增就好了。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">AssocContainer &lt;<span class="keyword">int</span>&gt; c;</span><br><span class="line"><span class="keyword">for</span>(AssocContainer &lt;<span class="keyword">int</span>&gt; :: iterator i = c.begin(); i!=c.end(); )&#123;</span><br><span class="line">    <span class="keyword">if</span> (badValue(*i)) c.erase(i++);</span><br><span class="line">    <span class="keyword">else</span> ++i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>若想要用此种遍历来解决 vector , string, deque时， 无法进行，因为 这类容器调用erase时，不仅会使所指向被删除元素的迭代器无效，也会使被删除元素之后的所有迭代器都无效。</strong></p>
<p>对于vector, string, deque， 我们需要采取不同的策略</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SeqContainer &lt;<span class="keyword">int</span>&gt; c;</span><br><span class="line"><span class="keyword">for</span>(SeqContainer &lt;<span class="keyword">int</span>&gt; :: iterator i = c.begin(); i!=c.end(); )&#123;</span><br><span class="line">    <span class="keyword">if</span> (badValue(*i)) i = c.erase(i);</span><br><span class="line">    <span class="keyword">else</span> ++i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注：原书中此处erase 能返回指向被删除元素的下个元素的迭代器，说是只对于标准序列容器才是如此，标准关联容器的返回值是void， 但C++11 中关联容器的erase 同样可以返回指向被删除元素的下个元素的迭代器。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>要删除容器中所有特定值的所有对象：</p>
<ul>
<li>如果是vector, string, 或deque, 则使用 erase-remove</li>
<li>如果容器是list， 则使用 list::remove</li>
<li>如果容器是一个标准关联容器，则使用他的erase 成员函数</li>
</ul>
<p>要删除容器内满足条件的所有对象:</p>
<ul>
<li>如果是vector, string, 或deque, 则使用 erase-remove_if</li>
<li>如果容器是list， 则使用 list::remove_if</li>
<li>如果容器是一个标准关联容器，则使用循环判定加上erase 成员函数</li>
</ul>
<p>要在循环内部做某些(除了删除对象之外的操作):</p>
<ul>
<li>写一个循环来遍历容器中的元素，记住每次调用erase时，要用它的返回值来更新迭代器。</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/17/GoneFishing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Andong Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Andong's Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/17/GoneFishing/" itemprop="url">
                  GoneFishing
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-08-17 21:29:27 / Modified: 21:30:14" itemprop="dateCreated datePublished" datetime="2018-08-17T21:29:27+08:00">2018-08-17</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Gone-Fishing"><a href="#Gone-Fishing" class="headerlink" title="Gone Fishing"></a>Gone Fishing</h3><h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><p>John is going on a fishing trip. He has h hours available (1 &lt;= h &lt;= 16), and there are n lakes in the area (2 &lt;= n &lt;= 25) all reachable along a single, one-way road. John starts at lake 1, but he can finish at any lake he wants. He can only travel from one lake to the next one, but he does not have to stop at any lake unless he wishes to. For each i = 1,…,n - 1, the number of 5-minute intervals it takes to travel from lake i to lake i + 1 is denoted ti (0 &lt; ti &lt;=192). For example, t3 = 4 means that it takes 20 minutes to travel from lake 3 to lake 4. To help plan his fishing trip, John has gathered some information about the lakes. For each lake i, the number of fish expected to be caught in the initial 5 minutes, denoted fi( fi &gt;= 0 ), is known. Each 5 minutes of fishing decreases the number of fish expected to be caught in the next 5-minute interval by a constant rate of di (di &gt;= 0). If the number of fish expected to be caught in an interval is less than or equal to di , there will be no more fish left in the lake in the next interval. To simplify the planning, John assumes that no one else will be fishing at the lakes to affect the number of fish he expects to catch.<br>Write a program to help John plan his fishing trip to maximize the number of fish expected to be caught. The number of minutes spent at each lake must be a multiple of 5. </p>
<h4 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h4><p>You will be given a number of cases in the input. Each case starts with a line containing n. This is followed by a line containing h. Next, there is a line of n integers specifying fi (1 &lt;= i &lt;=n), then a line of n integers di (1 &lt;=i &lt;=n), and finally, a line of n - 1 integers ti (1 &lt;=i &lt;=n - 1). Input is terminated by a case in which n = 0. </p>
<h4 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h4><p>For each test case, print the number of minutes spent at each lake, separated by commas, for the plan achieving the maximum number of fish expected to be caught (you should print the entire plan on one line even if it exceeds 80 characters). This is followed by a line containing the number of fish expected.<br>If multiple plans exist, choose the one that spends as long as possible at lake 1, even if no fish are expected to be caught in some intervals. If there is still a tie, choose the one that spends as long as possible at lake 2, and so on. Insert a blank line between cases.</p>
<h4 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">2 </span><br><span class="line">1 </span><br><span class="line">10 1 </span><br><span class="line">2 5 </span><br><span class="line">2 </span><br><span class="line">4 </span><br><span class="line">4 </span><br><span class="line">10 15 20 17 </span><br><span class="line">0 3 4 3 </span><br><span class="line">1 2 3 </span><br><span class="line">4 </span><br><span class="line">4 </span><br><span class="line">10 15 50 30 </span><br><span class="line">0 3 4 3 </span><br><span class="line">1 2 3 </span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<h4 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">45, 5 </span><br><span class="line">Number of fish expected: 31 </span><br><span class="line"></span><br><span class="line">240, 0, 0, 0 </span><br><span class="line">Number of fish expected: 480 </span><br><span class="line"></span><br><span class="line">115, 10, 50, 35 </span><br><span class="line">Number of fish expected: 724</span><br></pre></td></tr></table></figure>
<p>题意大致时说有沿直线排列的湖泊，其中每个湖泊所能捕捞的鱼以一定速率减少(仅当开始捕捞后才会开始减少)，湖与湖之间有一定的路程，问怎么样才能使的规定时间内涝出来的鱼最大。</p>
<p>这个题咋一思考很乱，怎么样才能确定在一个湖里面捞多久的鱼，需要考虑后面所有湖里的鱼的情况，很是复杂，但我们考虑以一次捕鱼的时间作为时间片，该时间片捞鱼完成后我们再选择鱼多的湖来捞鱼，这样可能发生A湖捞鱼捞完后去B湖捞， B湖捞完又回头捞， 但这种情况完全等效于在A楼捞完后再去B湖捞，因此我们以不同的湖作为终点，在总的时间内减去这些湖之间的交通时间，再以时间片为单位每次去鱼最多的湖里捞鱼，这样最后就可以找到最多的捞鱼数。注意题目中同时还有在相同的捞鱼数的情况下，尽可能得选择编号较小的湖。因此比较时将编号也加进去考虑。每次只选鱼最多的湖面我们因此使用priority_queue。</p>
<p>ac代码如下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;numeric&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iterator&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxLake = <span class="number">25</span>;</span><br><span class="line"><span class="keyword">int</span> fi[maxLake];</span><br><span class="line"><span class="keyword">int</span> di[maxLake];</span><br><span class="line"><span class="keyword">int</span> ti[maxLake];</span><br><span class="line"><span class="keyword">int</span> s[maxLake];</span><br><span class="line"><span class="keyword">int</span> si[maxLake];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Lake</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> f, d, index;</span><br><span class="line"></span><br><span class="line">    Lake(<span class="keyword">int</span> f, <span class="keyword">int</span> d, <span class="keyword">int</span> index) : f(f), d(d), index(index) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Lake&amp; l) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(f == l.f)</span><br><span class="line">            <span class="keyword">return</span> index &gt; l.index;  </span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> f &lt; l.f;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getF</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp = f;</span><br><span class="line">        f = max(f-d, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> tmp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l, h;</span><br><span class="line">    ti[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((<span class="built_in">cin</span> &gt;&gt; l) &amp;&amp; (l != <span class="number">0</span>))&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; h;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">0</span>; m &lt; l; ++m) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; fi[m];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">0</span>; m &lt; l; ++m) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; di[m];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">1</span>; m &lt; l; ++m) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; ti[m];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">-1</span>;  <span class="comment">//注意此处应小于0， 否则在捕鱼数为0的结果下，无法正常的更新在每个湖的停留时间</span></span><br><span class="line">        priority_queue &lt;Lake&gt; ql;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= l; ++i) &#123;</span><br><span class="line">            <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">memset</span>(si, <span class="number">0</span>, <span class="keyword">sizeof</span>(si));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; ++j)</span><br><span class="line">                ql.emplace(fi[j], di[j], j);</span><br><span class="line">            <span class="keyword">int</span> rh = h * <span class="number">12</span> - accumulate(ti, ti+i, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = rh; k &gt; <span class="number">0</span>; --k) &#123;</span><br><span class="line">                Lake tmp = ql.top();</span><br><span class="line">                sum += tmp.getF();</span><br><span class="line">                si[tmp.index] += <span class="number">5</span>;</span><br><span class="line">                ql.pop();</span><br><span class="line">                ql.emplace(tmp);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(sum &gt; result)&#123;</span><br><span class="line">                result = sum;</span><br><span class="line">                <span class="built_in">memcpy</span>(s, si, <span class="keyword">sizeof</span>(si));</span><br><span class="line">            &#125;</span><br><span class="line">            ql = priority_queue &lt;Lake&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        copy(s, s+l<span class="number">-1</span>, ostream_iterator&lt;<span class="keyword">int</span>&gt;(<span class="built_in">cout</span>, <span class="string">", "</span>));</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; s[l<span class="number">-1</span>] &lt;&lt; <span class="string">'\n'</span> &lt;&lt; <span class="string">"Number of fish expected: "</span> &lt;&lt; result &lt;&lt; <span class="string">"\n\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="http://bailian.openjudge.cn/practice/1042/" target="_blank" rel="noopener">POJ地址</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/17/4 Keys Keyboard/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Andong Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Andong's Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/17/4 Keys Keyboard/" itemprop="url">
                  4 Keys Keyboard
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-08-17 15:25:15 / Modified: 15:26:51" itemprop="dateCreated datePublished" datetime="2018-08-17T15:25:15+08:00">2018-08-17</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="leetcode-651-4-Keys-Keyboard"><a href="#leetcode-651-4-Keys-Keyboard" class="headerlink" title="leetcode 651. 4 Keys Keyboard"></a>leetcode 651. 4 Keys Keyboard</h2><p>Imagine you have a special keyboard with the following keys:</p>
<p><code>Key 1: (A)</code>: Prints one ‘A’ on screen.</p>
<p><code>Key 2: (Ctrl-A)</code>: Select the whole screen.</p>
<p><code>Key 3: (Ctrl-C)</code>: Copy selection to buffer.</p>
<p><code>Key 4: (Ctrl-V)</code>: Print buffer on screen appending it after what has already been printed.</p>
<p>Now, you can only press the keyboard for N times (with the above four keys), find out the maximum numbers of ‘A’ you can print on screen.</p>
<p>Example 1:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Input: N = 3</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: </span><br><span class="line">We can at most get 3 A&apos;s on screen by pressing following key sequence:</span><br><span class="line">A, A, A</span><br></pre></td></tr></table></figure>
<p>Example 2:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Input: N = 7</span><br><span class="line">Output: 9</span><br><span class="line">Explanation: </span><br><span class="line">We can at most get 9 A&apos;s on screen by pressing following key sequence:</span><br><span class="line">A, A, A, Ctrl A, Ctrl C, Ctrl V, Ctrl V</span><br></pre></td></tr></table></figure>
<p>Note:</p>
<ol>
<li>1 &lt;= N &lt;= 50</li>
<li>Answers will be in the range of 32-bit signed integer.</li>
</ol>
<p>分析: 操作来说 ctrl-a ctrl-c 必须连用，同时组合上不同个数的ctrl-v 来作为一次有效的操作，我们记为multiple-key，而仅输入A的行为我们假设在N次按键中， 有一定次数的该有效操作，这些有效操作必然是放在最后才能给我们带来一个最优的结果。接下来我们考虑ctrl-a ctrl-c ctrl-v ctrl-v ctrl-v ctrl-v 是否是mutiple-key中的最优解, 也就是用比较操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctrl-a ctrl-c ctrl-v ctrl-v ctrl-v ctrl-v</span><br><span class="line">ctrl-a ctrl-c ctrl-v ctrl-a ctrl-c ctrl-v</span><br></pre></td></tr></table></figure>
<p>假设本来屏幕上有X个字符，则方法1会带来$(n-2)$倍的增长 而方法2会带来$(2^ {\lfloor n/3 \rfloor})$ 倍的增长，很明显这个是一个需要分类讨论的问题， 但不管是哪一种的增长，必然是以一个multiple-key来结束的。</p>
<p>建立一个dp[N+1]数组，dp[k]表示k步操作下的最优解，如果最后一步不是multiple-key，则最优解是dp[k] = dp[k-1]+1, 此时不用考虑dp[k-2]+2, dp[k-3]+3这些，因为dp[i] &gt;= dp[i-1]+1,而如果最后一步是multiple-key,则<br>$$<br>dp[k] = \max _{1 \le i \le k-3} { dp[i] * (k-i-2+1)}<br>$$<br>其中i代表了k次操作中(A)的次数，剩下的就是ctrl-a ctrl-c ctrl-v ctrl-v … 这样不停的操作。</p>
<p>则代码如下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxA</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; dp(N + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</span><br><span class="line">            dp[i] = dp[i<span class="number">-1</span>] + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i - <span class="number">2</span>; ++j) &#123;</span><br><span class="line">                dp[i] = max(dp[i], dp[j] * (i - j - <span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[N];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>时间复杂度: O(n2)</p>
<p>空间复杂度: O(n)</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/01/Aggressive cows/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Andong Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Andong's Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/01/Aggressive cows/" itemprop="url">
                  Aggressive cows
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-08-01 16:46:03" itemprop="dateCreated datePublished" datetime="2018-08-01T16:46:03+08:00">2018-08-01</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-08-17 15:28:01" itemprop="dateModified" datetime="2018-08-17T15:28:01+08:00">2018-08-17</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天遇到一道有趣的题目，Aggressive cows，题目具体如下，</p>
<p>Farmer John has built a new long barn, with N (2 &lt;= N &lt;= 100,000) stalls. The stalls are located along a straight line at positions x1,…,xN (0 &lt;= xi &lt;= 1,000,000,000).</p>
<p>His C (2 &lt;= C &lt;= N) cows don’t like this barn layout and become aggressive towards each other once put into a stall. To prevent the cows from hurting each other, FJ want to assign the cows to the stalls, such that the minimum distance between any two of them is as large as possible. What is the largest minimum distance?</p>
<p>简单来讲就是假定给你n个坐标，让你任选b个坐标，使这b个坐标任意两点的最小距离最大，</p>
<p>题目想通了很简单，这个最大最小距离的取值范围是[1, max-min]，我们只需要利用二分法去寻找这个值，对于每一个值带进去看是否满足最小距离的条件成立即可。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxNum = <span class="number">100000</span>;</span><br><span class="line"><span class="keyword">int</span> pos[maxNum];</span><br><span class="line"><span class="keyword">int</span> numStall, numCow;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Judge</span><span class="params">(<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> tmp = pos[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">int</span> num = numCow - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; numStall; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>((pos[i] - tmp) &gt;= d)&#123;</span><br><span class="line">            <span class="keyword">if</span>(--num == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            tmp = pos[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BinSearch</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">1</span>, right = pos[numStall - <span class="number">1</span>] - pos[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">int</span> mid;</span><br><span class="line">    <span class="keyword">int</span> result;</span><br><span class="line">    <span class="keyword">while</span>(left &lt;= right)&#123;</span><br><span class="line">        mid = (left + right)/ <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(Judge(mid))&#123;</span><br><span class="line">            result = mid;</span><br><span class="line">            left = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            right = mid <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;numStall, &amp;numCow);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numStall; ++i) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;(pos[i]));</span><br><span class="line">    &#125;</span><br><span class="line">    sort(pos, pos + numStall);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; BinSearch() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/24/字符串乘方/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Andong Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Andong's Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/24/字符串乘方/" itemprop="url">
                  字符串乘方
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-07-24 21:18:00 / Modified: 21:46:43" itemprop="dateCreated datePublished" datetime="2018-07-24T21:18:00+08:00">2018-07-24</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="帮师姐刷面试题的时候遇到一个有意思的题，在POJ上找到了一个类似的题目-具体描述如下"><a href="#帮师姐刷面试题的时候遇到一个有意思的题，在POJ上找到了一个类似的题目-具体描述如下" class="headerlink" title="帮师姐刷面试题的时候遇到一个有意思的题，在POJ上找到了一个类似的题目,具体描述如下"></a>帮师姐刷面试题的时候遇到一个有意思的题，在POJ上找到了一个类似的<a href="http://bailian.openjudge.cn/practice/2406/" target="_blank" rel="noopener">题目</a>,具体描述如下</h3><h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><p>给定两个字符串a和b,我们定义a<em>b为他们的连接。例如，如果a=”abc” 而b=”def”， 则a</em>b=”abcdef”。 如果我们将连接考虑成乘法，一个非负整数的乘方将用一种通常的方式定义：a^0=””(空字符串)，a^(n+1)=a*(a^n)。</p>
<h4 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h4><p>每一个测试样例是一行可打印的字符作为输入，用s表示。s的长度至少为1，且不会超过一百万。最后的测试样例后面将是一个点号作为一行。</p>
<h4 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h4><p>对于每一个s，你应该打印最大的n，使得存在一个a，让s=a^n</p>
<h4 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">abcd</span><br><span class="line">aaaa</span><br><span class="line">ababab</span><br><span class="line">.</span><br></pre></td></tr></table></figure>
<h4 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">4</span><br><span class="line">3</span><br></pre></td></tr></table></figure>
<h4 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h4><p>本问题输入量很大，请用scanf代替cin，从而避免超时。</p>
<p>这道题也就是求构成字符串的最小重复单位，灵感来自于KMP算法的next数组。</p>
<p>KMP中next数组保存当前字符之前的子串的最大公共前缀后缀元素个数。</p>
<p>比如 abcab 的最大公共前缀后缀元素个数为 2,  abca的最大公共前缀后缀元素个数为1。</p>
<p>aaaaa的next数组如下所示：</p>
<table>
<thead>
<tr>
<th>a</th>
<th>a</th>
<th>a</th>
<th>a</th>
<th>a</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>-1</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>a</th>
<th>b</th>
<th>a</th>
<th>b</th>
<th>a</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>-1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>可以发现一个很有趣的现象，当next数组遍历过重复的子串之后，next数组对应的值会逐个增大。这很好理解，因为已经过了第一个重复的子串之后，最大前缀后缀数组都是从第二个重复子串的开头开始的。所以我们有这样的一个思路，当我们求出next数组后，如果该字符串是由重复的子串构成的，那么该串的最大公共前缀后缀的个数应该是重复子串的整数倍。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxNum = <span class="number">1000000</span>;</span><br><span class="line"><span class="keyword">int</span> nExt[maxNum];</span><br><span class="line"><span class="built_in">string</span> str;</span><br><span class="line"><span class="keyword">int</span> len;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">GetNext</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">-1</span>;</span><br><span class="line">    nExt[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; len)&#123;</span><br><span class="line">        <span class="keyword">if</span>( j == <span class="number">-1</span> ||  str[i] == str[j])&#123;</span><br><span class="line">            ++i; ++j;</span><br><span class="line">            nExt[i] = j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            j = nExt[j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; str;</span><br><span class="line">        <span class="keyword">if</span>(str == <span class="string">"."</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        len = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt; (str.length());</span><br><span class="line">        GetNext();</span><br><span class="line">        <span class="keyword">if</span> ((nExt[len] != <span class="number">0</span>) &amp;&amp; (nExt[len] % (len - nExt[len]) == <span class="number">0</span>))</span><br><span class="line">           <span class="built_in">cout</span> &lt;&lt; len/(len - nExt[len]) &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">           <span class="built_in">cout</span> &lt;&lt; <span class="string">"1\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们可以看到上面的求next数组的函数，求next数组的思路是怎么样的呢， next数组表示的含义是当前字符之前字符串的最大公共前缀后缀，求next[k]的值，就是要看str[next[k-1]]是否和str[k-1]相等,如果相等。 next[k] = next[k-1]+1， 如果不能，再看 str[next[next[k-1]]]的值，直到为-1，也就是没有一个相等的，此时next[k] = 0.</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/07/硬币/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Andong Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Andong's Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/07/硬币/" itemprop="url">
                  硬币
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-07-07 19:10:06 / Modified: 19:28:57" itemprop="dateCreated datePublished" datetime="2018-07-07T19:10:06+08:00">2018-07-07</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><p>宇航员Bob有一天来到火星上，他有收集硬币的习惯。于是他将火星上所有面值的硬币都收集起来了，一共有n种，每种只有一个：面值分别为a1,a2… an。 Bob在机场看到了一个特别喜欢的礼物，想买来送给朋友Alice，这个礼物的价格是X元。Bob很想知道为了买这个礼物他的哪些硬币是必须被使用的，即Bob必须放弃收集好的哪些硬币种类。飞机场不提供找零，只接受恰好X元。</p>
<h4 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h4><p>第一行包含两个正整数n和x。（1 &lt;= n &lt;= 200, 1 &lt;= x &lt;= 10000) 第二行从小到大为n个正整数a1, a2, a3 … an （1 &lt;= ai &lt;= x)</p>
<h4 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h4><p>第一行是一个整数，即有多少种硬币是必须被使用的。 第二行是这些必须使用的硬币的面值（从小到大排列）。</p>
<h4 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">5 18</span><br><span class="line">1 2 3 5 10</span><br></pre></td></tr></table></figure>
<h4 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">5 10</span><br></pre></td></tr></table></figure>
<h4 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h4><p>输入数据将保证给定面值的硬币中至少有一种组合能恰好能够支付X元。 如果不存在必须被使用的硬币，则第一行输出0，第二行输出空行。</p>
<h4 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h4><p><a href="http://bailian.openjudge.cn/practice/4120/" target="_blank" rel="noopener">poj</a></p>
<h3 id="思路："><a href="#思路：" class="headerlink" title="思路："></a>思路：</h3><p>题目要求的是在和为X元时，必须所要使用的硬币个数，很自然的可以想到使用H<br>$$<br>H(X) = (x_1, x_2, …, x_n) 其中x_i\in{0,1}<br>$$<br>来表示一个状态，具体表示为和为X元的时候，必须使用的硬币的状态值，1表示对应的硬币必须被使用。反之则用0来表示。</p>
<p>比如在样例输入的情况下,H(1) =  (1, 0, 0, 0, 0)，那么状态间如何转移了,在样本的集合为{1,2}情况下， H(3) = (1, 1, 0, 0, 0)， 当样本变为{3}情况下，H(3) = (0, 0, 1, 0, 0), 样本为{1, 2, 3}的情况下，  H(3) = (0, 0, 0, 0, 0)， 很明显按位与能达到我们想要的效果。思路到现在为止已经呼之欲出了，问题已经简化为到X元的各种路径的硬币相与，则我们可以假设一个X列的二维数组，其中每一行为各个硬币对应的bool值，再考虑将硬币从第一枚逐个放入，并按照从大到小的顺序与二维数组中已凑出的x相与(从大到小是考虑到每个硬币仅仅能够使用一次，如果从小到大，比如1，3，4，二维数组第4行的值会先修改，而有进行了4+4=8 的计算，相当于4被使用了两次，因而思路错误)，最后便可以得到X元的结果。</p>
<h4 id="手推示例"><a href="#手推示例" class="headerlink" title="手推示例"></a>手推示例</h4><h5 id="初始状态"><a href="#初始状态" class="headerlink" title="初始状态"></a>初始状态</h5><table>
<thead>
<tr>
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>5</th>
<th>10</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>…</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>18</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<h5 id="放入1后"><a href="#放入1后" class="headerlink" title="放入1后"></a>放入1后</h5><table>
<thead>
<tr>
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>5</th>
<th>10</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>…</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>18</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<h5 id="放入2后"><a href="#放入2后" class="headerlink" title="放入2后"></a>放入2后</h5><table>
<thead>
<tr>
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>5</th>
<th>10</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>…</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>18</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<h5 id="放入3后"><a href="#放入3后" class="headerlink" title="放入3后"></a>放入3后</h5><table>
<thead>
<tr>
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>5</th>
<th>10</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>5</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>…</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>18</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<h5 id="放入5后"><a href="#放入5后" class="headerlink" title="放入5后"></a>放入5后</h5><table>
<thead>
<tr>
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>5</th>
<th>10</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>4</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>5</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>6</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>7</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>8</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>9</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>10</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>…</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>18</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>放入10懒得画了，与前面同理，前面几项示例的应该已经很清晰了</p>
<p>这个思路写出来会time limit exceed，因为中间有很多无用的过渡状态，所以浪费了很多的时间。</p>
<p>还是用这个思路，只是将状态位的0,1用bitset来表示，内存使用从8088kB降到656kB， 时间从1357ms降到了77ms，4B的数组表示1bite的数据果然是暴殄天物，太浪费了。</p>
<p>具体ac代码如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bitset&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> max_num = <span class="number">200</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> max_total = <span class="number">10000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> coin[max_num];</span><br><span class="line"><span class="built_in">vector</span> &lt; <span class="built_in">bitset</span>&lt;max_num&gt; &gt; result(max_total+<span class="number">1</span>);</span><br><span class="line"><span class="built_in">bitset</span>&lt;max_total+1&gt; bf; <span class="comment">//表示该数是否可以用之前数字的组合表示出来</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num_coin,total;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span> &gt;&gt; num_coin &gt;&gt; total)&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">0</span>; m &lt; num_coin; ++m) &#123;</span><br><span class="line">            <span class="built_in">cin</span>&gt;&gt;coin[m];</span><br><span class="line">        &#125;</span><br><span class="line">        sort(coin, coin+num_coin);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp; b : result)&#123;</span><br><span class="line">            b.<span class="built_in">set</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        result[<span class="number">0</span>].reset();</span><br><span class="line">        bf.<span class="built_in">set</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> j, flag = <span class="number">0</span>;  <span class="comment">//flag表示所加到的最大的数为多少</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num_coin; ++i) &#123;</span><br><span class="line">            j = flag;</span><br><span class="line">            <span class="keyword">for</span> (; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">                <span class="keyword">if</span>(bf[j]) &#123;</span><br><span class="line">                    <span class="keyword">int</span> tmp = j + coin[i];</span><br><span class="line">                    <span class="keyword">if</span>(tmp &lt;= total)&#123;</span><br><span class="line">                        flag = max(tmp, flag);</span><br><span class="line">                        result[j].<span class="built_in">set</span>(i);</span><br><span class="line">                        result[tmp] &amp;= result[j];</span><br><span class="line">                        result[j].reset(i);</span><br><span class="line">                        bf.<span class="built_in">set</span>(tmp);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">auto</span> sum = <span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(result[total].count());</span><br><span class="line">        <span class="keyword">if</span>(!bf[total] || (!sum))</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;<span class="number">0</span>&lt;&lt;<span class="string">"\n\n"</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; sum &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>; l &lt; num_coin; ++l) &#123;</span><br><span class="line">                <span class="keyword">if</span>(result[total][l])</span><br><span class="line">                    <span class="built_in">cout</span>&lt;&lt;coin[l]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/17/C-右值引用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Andong Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Andong's Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/17/C-右值引用/" itemprop="url">
                  C++右值引用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-06-17 16:10:43 / Modified: 17:28:32" itemprop="dateCreated datePublished" datetime="2018-06-17T16:10:43+08:00">2018-06-17</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="本篇我们讨论C-11-引入的右值引用。"><a href="#本篇我们讨论C-11-引入的右值引用。" class="headerlink" title="本篇我们讨论C++ 11 引入的右值引用。"></a>本篇我们讨论C++ 11 引入的右值引用。</h3><p>注：g++编译器做了很多优化，为了分析原理，本篇的测试全部是在以下编译条件下进行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g++ -fno-elide-constructors  -std=c++11 test.cpp</span><br></pre></td></tr></table></figure>
<p>考虑这样一个简单的例子</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">String</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">char</span>* str;</span><br><span class="line">    String():str(<span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1</span>])&#123;str[<span class="number">0</span>]=<span class="number">0</span>;&#125;</span><br><span class="line">    String(<span class="keyword">const</span> <span class="keyword">char</span>* s)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"constructor called"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        str = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(s)+<span class="number">1</span>];</span><br><span class="line">        <span class="built_in">strcpy</span>(str,s);</span><br><span class="line">    &#125;</span><br><span class="line">    String(<span class="keyword">const</span> String&amp; s)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"copy constructor called"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        str = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(s.str)+<span class="number">1</span>];</span><br><span class="line">        <span class="built_in">strcpy</span>(str,s.str);</span><br><span class="line">    &#125;</span><br><span class="line">    String &amp;<span class="keyword">operator</span> = (<span class="keyword">const</span> String&amp; s)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"copy operator = called"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">if</span>(str!= s.str)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">delete</span> []str;</span><br><span class="line">            str = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="built_in">strlen</span>(s.str)+<span class="number">1</span>];</span><br><span class="line">            <span class="built_in">strcpy</span>(str,s.str);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ~String() </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">delete</span> [] str;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>我们用右值来对r进行赋值</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String s = String(<span class="string">"hello"</span>);</span><br></pre></td></tr></table></figure>
<p>题外：从这句话我们可以理解引用的好处，如果是单纯的按值传递，我们在形参的初始时就需要额外的进行构造函数的开销。为了能够接收右值，构造函数同时也必须采用const引用，因为没有从右值到左值的隐式转换。</p>
<p>得到的结果为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">constructor called</span><br><span class="line">copy constructor called</span><br></pre></td></tr></table></figure>
<p>可以看到在赋值过程中，执行了一次构造函数，一次拷贝构造函数，拷贝构造函数需要进行深拷贝，这就很浪费时间，而临时对象的内容在使用它语句结束之后也不会再被使用，如果我们直接把临时对象中的内容move给s,换句话说，直接令s中的str指向临时对象str所指向的地方，在将临时对象中的str指向一个新的非空的char数组，那不是无论我们赋值时得到的char数组有多长，我们总是有一个恒定的小的时间复杂度来进行深拷贝的工作，问题的关键就在于如何能去访问临时对象并进行修改，而C++11提供给我们的右值引用可以使我们能够实现这个想法。</p>
<p>对String类再编写移动构造函数和移动赋值号。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">String(String &amp;&amp; s):str(s.str)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"move constructor called"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    s.str = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1</span>];</span><br><span class="line">    s.str[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">String &amp;<span class="keyword">operator</span> = (String&amp;&amp; s)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"move operator = called"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">if</span>(str!= s.str)</span><br><span class="line">    &#123;</span><br><span class="line">        str = s.str;</span><br><span class="line">        s.str = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1</span>];</span><br><span class="line">        s.str[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>再运行</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String s = String(<span class="string">"hello"</span>);</span><br></pre></td></tr></table></figure>
<p>此时的结果为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">constructor called</span><br><span class="line">move constructor called</span><br></pre></td></tr></table></figure>
<p>可以看到我们直接把s的str指向了临时对象的str所指向的空间，再重新将str的空间赋为’\0’,便完成了s的初始化，简单粗暴而又符合自然的move的逻辑。</p>
<p>右值引用所带给我们的move的逻辑在函数按值返回，接收右值表达式等有很多的便利，很多地方完全没有任何对右值引用的显式使用，却能带来性能的提升。这一部分具体可以参考知乎的回答<a href="https://www.zhihu.com/question/22111546/answer/30801982" target="_blank" rel="noopener">如何评价 C++11 的右值引用（Rvalue reference）特性</a>。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/15/C++左值和右值/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Andong Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Andong's Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/15/C++左值和右值/" itemprop="url">
                  C++左值和右值
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-06-15 16:30:06 / Modified: 17:05:16" itemprop="dateCreated datePublished" datetime="2018-06-15T16:30:06+08:00">2018-06-15</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>​    首先明确一些概念，对象(object)在C/C++中指的是执行环境中的一块儿存储区域(a region of storage)，该存储区域中的内容代表(represent)了该对象的值(value)。我们这里提到的“代表 ”，是说对于一个对象，当我们取出(fetch)它的值时，我们需要一定的类型(type)来引用它。使用不同的类型，对同一对象中的内容的解释可能会得到不同的值。变量(variable)则是一种声明，通过声明，将一个名字(name)和一个对象对应起来，使用这个名字时，表示了我们对该对象进行了某种操作。</p>
<p>​    而左值(lvalue)是指拥有可识别位置(identifiable memory location)的对象(比如地址)，而不是左值的即是右值(rvalue)。</p>
<h4 id="基本例子"><a href="#基本例子" class="headerlink" title="基本例子"></a>基本例子</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> var;</span><br><span class="line">var = <span class="number">4</span>;</span><br></pre></td></tr></table></figure>
<p>赋值操作需要左值来作为左操作数(left operand)，而var有可识别位置，因此上面的赋值是成立的。同理，下面的式子是错误的。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span> = var;       <span class="comment">// ERROR!</span></span><br><span class="line">(var + <span class="number">1</span>) = <span class="number">4</span>; <span class="comment">// ERROR!</span></span><br></pre></td></tr></table></figure>
<p>一般来说，能出现在赋值号左边的表达式都是”左值”，非const的变量都是左值，函数调用时的返回值如果不是引用，那么该函数调用就是右值的。</p>
<h4 id="左值和右值的转换"><a href="#左值和右值的转换" class="headerlink" title="左值和右值的转换"></a>左值和右值的转换</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a = <span class="number">1</span>;     <span class="comment">// a is an lvalue</span></span><br><span class="line"><span class="keyword">int</span> b = <span class="number">2</span>;     <span class="comment">// b is an lvalue</span></span><br><span class="line"><span class="keyword">int</span> c = a + b; <span class="comment">// + needs rvalues, so a and b are converted to rvalues</span></span><br><span class="line">               <span class="comment">// and an rvalue is returned</span></span><br></pre></td></tr></table></figure>
<p>在进行相加操作时，左值隐式转换为了右值，事实上，所有非(arrays, functions or of incomplete types)都可以转换为右值，但右值无法隐式转换为左值，但右值可以通过一些显式的手段转换为左值，比如，一元操作符 $*$ (dereference) 接受一个右值的输入但返回一个左值，</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> arr[] = &#123;<span class="number">1</span>, <span class="number">2</span>&#125;;</span><br><span class="line"><span class="keyword">int</span>* p = &amp;arr[<span class="number">0</span>];</span><br><span class="line">*(p + <span class="number">1</span>) = <span class="number">10</span>;   <span class="comment">// OK: p + 1 is an rvalue, but *(p + 1) is an lvalue</span></span><br></pre></td></tr></table></figure>
<p>相反的，一元操作符 &amp; (reference) 接收左值并返回一个右值。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> var = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span>* bad_addr = &amp;(var + <span class="number">1</span>); <span class="comment">// ERROR: lvalue required as unary '&amp;' operand</span></span><br><span class="line"><span class="keyword">int</span>* addr = &amp;var;           <span class="comment">// OK: var is an lvalue</span></span><br><span class="line">&amp;var = <span class="number">40</span>;                  <span class="comment">// ERROR: lvalue required as left operand</span></span><br><span class="line">                            <span class="comment">// of assignment</span></span><br></pre></td></tr></table></figure>
<p>非const左值引用无法被右值初始化，因为没有从右值到左值的隐式转化。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::<span class="built_in">string</span>&amp; sref = <span class="built_in">std</span>::<span class="built_in">string</span>();  <span class="comment">// ERROR: invalid initialization of</span></span><br><span class="line">                                    <span class="comment">// non-const reference of type</span></span><br><span class="line">                                    <span class="comment">// 'std::string&amp;' from an rvalue of</span></span><br><span class="line">                                    <span class="comment">// type 'std::string'</span></span><br></pre></td></tr></table></figure>
<p>const左值引用可以被右值初始化，C++中函数用constant references接收参数，避免了没有意义的拷贝和构造临时对象。</p>
<h4 id="关于数组："><a href="#关于数组：" class="headerlink" title="关于数组："></a>关于数组：</h4><p>​    在需要右值的场合，数组名会隐式转换为其首个元素的地址，不发生这种退化的情况有几个场合：一是声明时；一是用作sizeof的操作数时；一是用作&amp;取址运算的操作数时。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a[<span class="number">3</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;; </span><br><span class="line"><span class="keyword">int</span> b[<span class="number">3</span>]; </span><br><span class="line">b=a; <span class="comment">//error. b converted to int* (rvalue): array degration. </span></span><br><span class="line"><span class="keyword">int</span>* p=a; <span class="comment">//array degration: a converted to an rvalue of int* </span></span><br><span class="line"><span class="keyword">sizeof</span>(a); <span class="comment">// no degration. </span></span><br><span class="line">&amp;a; <span class="comment">//no degration.</span></span><br></pre></td></tr></table></figure>
<p>​    C++中，数组还有其他场合不发生退化，比如作为引用的initialize。</p>
<hr>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><ul>
<li><a href="https://web.archive.org/web/20160112040816/http://eli.thegreenplace.net/2011/12/15/understanding-lvalues-and-rvalues-in-c-and-c/" target="_blank" rel="noopener">Understanding lvalues and rvalues in C and C++</a></li>
<li><a href="https://www.zhihu.com/question/25814721/answer/31648501" target="_blank" rel="noopener">如何正确并合理的使用数组，指针*和取地址符&amp;?</a></li>
<li><a href="http://www.newsmth.net/nForum/#!article/CPlusPlus/179727?p=1#a0" target="_blank" rel="noopener">C/C++的左值</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/27/xgboost调参/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Andong Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Andong's Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/27/xgboost调参/" itemprop="url">
                  xboost调参
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-05-27 16:24:01" itemprop="dateCreated datePublished" datetime="2018-05-27T16:24:01+08:00">2018-05-27</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-06-15 18:07:12" itemprop="dateModified" datetime="2018-06-15T18:07:12+08:00">2018-06-15</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><h3 id="General-Parameters"><a href="#General-Parameters" class="headerlink" title="General Parameters:"></a><strong>General Parameters:</strong></h3><ol>
<li><strong>booster [default=gbtree]:</strong>  选择每一个iteration所使用的模型，有两个选项<ul>
<li>gbtree: tree-based models</li>
<li>gblinear: linear models</li>
</ul>
</li>
<li><strong>silent [default=0]：</strong>  运行的过程中是否打印信息</li>
<li><strong>nthread [default to maximum number of threads available if not set]</strong> </li>
</ol>
</li>
<li><h3 id="Booster-Parameters-这里主要指的是gbtree的选项，gblinear用的很少"><a href="#Booster-Parameters-这里主要指的是gbtree的选项，gblinear用的很少" class="headerlink" title="Booster Parameters: 这里主要指的是gbtree的选项，gblinear用的很少"></a><strong>Booster Parameters:</strong> 这里主要指的是gbtree的选项，gblinear用的很少</h3><ol>
<li><strong>eta [default=0.3]：</strong>给予每一个模型的权重，可以使得模型更坚固，但也会需要更多的模型，产生额外的开销。一般值的设定为0.01-0.2</li>
<li><strong>min_child_weight [default=1]：</strong> 类似于gbm的<strong>min_samples_leaf</strong>选项，但是限定的是子结点中最小的样本权重的和，同样的，取较高的值可以防止过拟合(阻止模型挖掘属于特定数据的特定特征)，但太高了会造成欠拟合，应该用CV调整。</li>
<li><strong>max_depth [default=6]：</strong> 最大树深，可用来控制过拟合，应该用CV调整，一般取值在3-10之间。</li>
<li><strong>max_leaf_nodes:</strong> 树所能拥有的最大的叶子结点数目，如果该项定义，会忽略掉<strong>max_depth</strong> 的值。</li>
<li><strong>gamma [default=0]:</strong> 节点分裂所需的最小的增益值。使模型更加conservative。</li>
<li><strong>subsample [default=1]：</strong> 喂给每一颗树的数据集比例，值取得小使得模型更加坚固，防止过拟合，但太小了会造成欠拟合，一般取0.5-1。</li>
<li><strong>colsample_bytree [default=1]：</strong> 分裂结点时所用的特征数目，一般取0.5-1。值取得过高可能会导致过拟合，但也取决于不同的样本。</li>
<li><strong>lambda [default=1]:</strong> L2 regularization term的权重</li>
<li><strong>alpha [default=0]:</strong>  L1 regularization term的权重，一般用在数据的维度非常高的时候，降低运行速度。</li>
<li><strong>scale_pos_weight [default=1]:</strong>  用于不平衡的数据，控制数据的比例，一个典型的值的设定为 sum(negative cases) / sum(positive cases) </li>
</ol>
</li>
<li><h3 id="Learning-Task-Parameters"><a href="#Learning-Task-Parameters" class="headerlink" title="Learning Task Parameters"></a>Learning Task Parameters</h3><ol>
<li><p><strong>objective [default=reg:linear]:</strong> 损失函数</p>
<ul>
<li><p><strong>binary:logistic</strong> –logistic regression for binary classification, returns predicted probability (not class)</p>
</li>
<li><p><strong>multi:softmax</strong> –multiclass classification using the softmax objective, returns predicted class (not probabilities)，使用时需要设置num_class的值。</p>
</li>
<li><p><strong>multi:softprob</strong> –same as softmax, but returns predicted probability of each data point belonging to each class.</p>
</li>
</ul>
</li>
<li><strong>eval_metric [ default according to objective ]:</strong> The metric to be used for validation data. 默认的值为回归问题使用rmse，分类问题使用error。典型的值设定有；<ul>
<li><strong>rmse</strong> – root mean square error</li>
<li><strong>mae</strong> – mean absolute error</li>
<li><strong>logloss</strong> – negative log-likelihood</li>
<li><strong>error</strong> – Binary classification error rate (0.5 threshold)</li>
<li><strong>merror</strong> – Multiclass classification error rate</li>
<li><strong>mlogloss</strong> – Multiclass logloss</li>
<li><strong>auc:</strong> Area under the curve</li>
</ul>
</li>
<li><strong>seed [default=0]:</strong> 用来重复实验以及调参。</li>
</ol>
</li>
</ol>
<hr>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><ul>
<li><a href="https://www.analyticsvidhya.com/blog/2016/03/complete-guide-parameter-tuning-xgboost-with-codes-python/" target="_blank" rel="noopener">Complete Guide to Parameter Tuning in XGBoost</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/21/GBDT/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Andong Lee">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Andong's Blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/21/GBDT/" itemprop="url">
                  Xgboost
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-05-21 09:35:06" itemprop="dateCreated datePublished" datetime="2018-05-21T09:35:06+08:00">2018-05-21</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-06-15 19:01:34" itemprop="dateModified" datetime="2018-06-15T19:01:34+08:00">2018-06-15</time>
              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Xgboost"><a href="#Xgboost" class="headerlink" title="Xgboost"></a>Xgboost</h2><hr>
<h4 id="Model："><a href="#Model：" class="headerlink" title="Model："></a>Model：</h4><p>假设我们有k棵回归树<br>$$<br>H(x) = \sum_{k=1}^{K}{f_k(x_i),}   \quad f_k\in F<br>$$</p>
<h4 id="Parameter"><a href="#Parameter" class="headerlink" title="Parameter:"></a>Parameter:</h4><p>每一个参数就就是一棵不同的回归树<br>$$<br>\Theta = {f_1, f_2, … f_T}<br>$$</p>
<h4 id="Object-function"><a href="#Object-function" class="headerlink" title="Object function:"></a>Object function:</h4><p>前一部分为损失函数，后一部分为正则项。<br>$$<br>Obj = \sum_{i=1}^nl(y_i,\hat y_i)+\sum_{k=1}^K \Omega(f_k)<br>$$</p>
<hr>
<h3 id="如何进行训练"><a href="#如何进行训练" class="headerlink" title="如何进行训练"></a>如何进行训练</h3><p>当训练到第t次时，<br>$$<br>Obj^{(t)} = \sum_{i=1}^nl(y_i,\hat y_i^{(t-1)}+f_t(x))+\Omega(f_t)+constant<br>$$</p>
<p>令$g_i = \frac{\partial(y_i,\hat y_i)}{\partial\hat y_i}|_{\hat y_i = \hat y^{(t-1)}}$ , $h_i = \frac{\partial^2(y_i,\hat y_i)}{\partial\hat y_i^2}|_{\hat y_i = \hat y^{(t-1)}}$</p>
<p>则对目标函数做泰勒展开可以得到<br>$$<br>\begin{aligned}<br>Obj^{(t)} &amp;\approx \sum_{i=1}^n \left(l (y_i,\hat y_i^{(t-1)})+ g_if_t(x_i)+\frac{1}{2}h_if_t^2(x_i) \right)+\Omega(f_t)+constant\\<br>&amp;= \sum_{i=1}^n \left( g_if_t(x_i)+\frac{1}{2}h_if_t^2(x_i)  \right)+\Omega(f_t)+constant\\<br>\end{aligned}<br>$$<br>可以看到第t步的目标函数依赖于$g_i$和$h_i$函数，以及$\hat y^{(t-1)}$的值。</p>
<p>定义回归树函数为：<br>$$<br>f_t(x)=w_{q(x)}  \quad w\in R^T, q: R^d \to {1,2,…,T}<br>$$<br>再定义回归树的惩罚函数为：<br>$$<br>\Omega(f_t) =\gamma T + \frac{1}{2}\lambda \sum_{j=1}^T{w_j^2}<br>$$</p>
<p>此时将回归树模型代入上述的目标函数中，并令$I_j = { x_i | q(x_i) = j }$, 再按照叶子结点来将输入分组，则可以得到<br>$$<br>\begin{aligned}<br>Obj^{(t)} &amp;\approx \sum_{i=1}^n \left( g_if_t(x_i)+\frac{1}{2}h_if_t^2(x_i)  \right)+\Omega(f_t)\\<br>&amp;=\sum_{i=1}^n \left( g_iw_q(x_i) + \frac{1}{2}h_iw_q^2(x_i)  \right)+ \gamma T + \frac{1}{2}\lambda \sum_{j=1}^T{w_j^2} \\<br>&amp;= \sum_{j=1}^T \left(   (\sum_{i\in I_j} {g_i})w_j +\frac{1}{2} (\sum_{i\in I_j} {h_i+\lambda})w_j^2  \right) + \gamma T<br>\end{aligned}<br>$$<br>再令$G_j = \sum_{i \in I_j } g_i$, $H_j = \sum_{i \in I_j } h_i$<br>$$<br>\begin{aligned}<br>Obj^{(t)}  &amp;= \sum_{j=1}^T \left(   (\sum_{i\in I_j} {g_i})w_j +\frac{1}{2} (\sum_{i\in I_j} {h_i+\lambda})w_j^2  \right) + \gamma T \\<br>&amp; = \sum_{j=1}^T \left(   G_jw_j +\frac{1}{2} (H_j+\lambda)w_j^2  \right) + \gamma T \\<br>\end{aligned}<br>$$<br>则当树的结构确定的时候，最优的叶子权重值以及最优的目标函数值就为<br>$$<br>w^*_j = -\frac{G_j}{H_j+\lambda} \qquad<br>Obj =-\frac{1}{2}\sum_{j=1}^{T}\frac{G_j^2}{H_j+\lambda} + \gamma T<br>$$</p>
<hr>
<h3 id="单棵树搜索算法"><a href="#单棵树搜索算法" class="headerlink" title="单棵树搜索算法"></a>单棵树搜索算法</h3><h4 id="精确建树"><a href="#精确建树" class="headerlink" title="精确建树"></a>精确建树</h4><p>这样我们就确定了对于单棵树的搜索算法</p>
<p>1.枚举出所有树的可能性</p>
<p>2.计算出对应每种树的目标函数，选择最大的作为此次构造的树的结构</p>
<p>3.在选取的树的结构下,计算出每个叶子结点的最优权值</p>
<p>但是树的所有的可能性是无穷的，我们使用贪心算法，将这个目标函数作为信息增益，自顶向下建立出整棵树，</p>
<p>这样整个树的算法变为了</p>
<p>1.初始深度为0</p>
<p>2.对每一个叶节点，判断是否会分裂<br>$$<br>Gain = \frac{1}{2}\left[  \frac{G_L^2}{H_L+\lambda}+\frac{G_R^2}{H_R+\lambda}-<br>\frac{G_R^2+G_L^2}{H_L+H_R+\lambda} - \gamma       \right]<br>$$<br>依次扫描所有的属性，对同一个属性，从左向右的扫描所有的点，从而选出gain最高的点，如果gain&gt;threshold，则进行分裂。</p>
<p>分裂算法如下：</p>
<p><img src="https://github.com/Leeandong/markdown_pictures/blob/master/Exact%20Greedy%20Algorithm%20for%20Split%20Finding.png?raw=true" alt=""></p>
<p>其中m为当前叶子结点的属性数目，$X_{jk}$ 中$j$ 代表当前分裂的位置，k代表属性值。 外层循环是对属性的遍历，内层节点是对分裂位置的遍历。算法的时间复杂度为 O(ndKlogn)。</p>
<h4 id="近似建树"><a href="#近似建树" class="headerlink" title="近似建树"></a>近似建树</h4><p>上述算法的时间复杂度过高，我们可以采用近似的方法，将样本先分成多少个小区间，再对每个区间进行操作，从而节省工作量，那么分割位点我们该如何选取呢？分割的结果自然是越均匀越好，这样才能得到一个有效的近似。我们将目标函数整理成以下的形式：<br>$$<br>Obj^{(t)} = \sum_{i=1}^n \frac{1}{2} h_i(f_t(x_i)- \frac{g_i}{h_i})^2+\Omega(f_t)+constant<br>$$<br>可以看出$h_i$有对loss有加权作用，因此我们采用$h_i$作为权重进行分割。</p>
<p>这样就得到了改进后的分裂算法</p>
<p><img src="https://github.com/Leeandong/markdown_pictures/blob/master/Approximate%20Algorithm%20for%20Split%20Finding.png?raw=true" alt=""></p>
<p>可以看到有全局和局部两种类型的分位点，其中全局分位点是指在建树之前就已经选取好所有的分位点，而局部分位点是在每一个结点分裂过程中选取分位点，可以对深的树有良好的效果，实验中发现，全局k分位点取20和局部k分位点取3，得到了近似的效果。</p>
<hr>
<h4 id="稀疏样本的处理"><a href="#稀疏样本的处理" class="headerlink" title="稀疏样本的处理"></a>稀疏样本的处理</h4><p>​    实际处理中，数据有很大可能是稀疏的，如果我们对于稀疏值有处理的方式，能够极大的提高我们算法运行的速度，xgboost中如果遇到了缺失的值，这个样本会被分入一个默认的方向。</p>
<p><img src="https://github.com/Leeandong/markdown_pictures/blob/master/Tree%20structure%20with%20default%20directions.png?raw=true" alt=""></p>
<p>而为了完成default的操作，先假设missing value在右子树上，求得此时的最大gain，再假设missing value在左子树上，求得此时最大gain，比较下来哪种情况最大，则对应的假设方向就是default的方向。这里的话貌似又是一个可以并行计算的点。<br>具体的算法如下：</p>
<p><img src="https://github.com/Leeandong/markdown_pictures/blob/master/%20Sparsity-aware%20Split%20Finding.png?raw=true" alt=""></p>
<p>后面还有一些硬件方面的优化，待续吧emmmm。</p>
<hr>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><ul>
<li><a href="https://homes.cs.washington.edu/~tqchen/pdf/BoostedTree.pdf" target="_blank" rel="noopener">Introduction to Boosted Trees </a></li>
<li><a href="http://www.kdd.org/kdd2016/papers/files/rfp0697-chenAemb.pdf" target="_blank" rel="noopener">XGBoost: A Scalable Tree Boosting System</a></li>
<li><a href="http://wepon.me/files/gbdt.pdf" target="_blank" rel="noopener">GBDT算法原理与系统设计简介 </a></li>
<li><a href="http://www.pengfoo.com/post/machine-learning/2017-03-03" target="_blank" rel="noopener">XGBoost all in one</a></li>
<li><a href="http://wepon.me/2016/05/07/XGBoost浅入浅出/" target="_blank" rel="noopener">XGBoost浅入浅出</a></li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Andong Lee</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">14</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">6</span>
                    <span class="site-state-item-name">tags</span>
                  
                </div>
              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Andong Lee</span>

  

  
</div>




  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Muse</a> v6.2.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.2.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.2.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.2.0"></script>



  



	





  





  










  





  

  

  

  
  

  
  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      },
      TeX: {equationNumbers: { autoNumber: "AMS" }}
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="//cdn.jsdelivr.net/npm/mathjax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    
  


  
  

  

  

  

  

  

</body>
</html>
